## 可转债定价模型概述

### 一、可转债的常见条款
#### 1. 赎回条款
1）提前赎回：提前赎回的目的是在正股股价较高时，督促投资者转股。提前赎回的触发条件一般格式为：在转股期内，如果公司股票连续X个交易日中至少有Y个交易日的收盘价格不低于当期转股价格的Z%，则触发赎回条款。例如：在转股期内，如果公司A股股票连续30个交易日中至少有15个交易日的收盘价格不低于当期转股价格的 130%（含 130%），则触发提前赎回。提前赎回时，公司有权决定按照债券面值加当期应计利息的价格赎回全部或部分未转股的可转债，或者投资者转股。
2）到期赎回：到期赎回时，发行人会按一定上浮比例赎回债券。例：公司将以本次发行的可转债的票面面值的107%（含最后一期利息）向投资者赎回全部未转股的可转债。

#### 2. 回售条款
回售条款的目的是保护投资者的权益。即当一段时间内股票价格过低时，投资者可以将可转债回售给发行人。回售的触发期限较短，一般为最后两年，回售条件一般格式如下：在最后两个计息年度任何连续X个交易日的股票收盘价格低于当期转股价格的Y%时，触发回售。

#### 3. 下修条款
下修条款的目的是当正股股票价格较低时，发行人可以有机会下修转股价，有利于转股。下修条件格式如下：在可转债存续期间，当本公司股票在任意连续X个交易日中有Y个交易日的收盘价低于当期转股价格的 Z%时，公司董事会有权提出转股价格向下修正方案并提交本公司股东大会表决。

下修后的转股价格一般要求不低于股东大会前 20 个交易日股票交易均价和前 1 交易日的交易均价，并低于之前的转股价格。发生下修后，其他条款应根据下修后的价格进行重新计算，回售条件的累计时间将重计。

### 二、定价模型的假设
基于可转债的特点，本模型对可转债定价所基于的假设如下：
#### 1. 将股票视为期权的标的资产
#### 2. 正股股价服从几何布朗运动
#### 3. 将转股条款作为欧式期权处理，即除非转债到期或者达到赎回条款的条件，持有人不会进行转股
#### 4. 使用与可转债同期限的国债到期收益率的最新价值作为无风险利率，并设其为常数，用于几何布朗运动的构建和未来价值的折现。
#### 5. 考虑违约风险，使用了同等级企业债收益率对债券部分进行折现
#### 6. 考虑赎回的不确定性：即触发赎回条款的可转债中，会进行赎回的概率为69.59%

假设原因：由于近年来，市场上出现了公司发布不赎回公告以及触发赎回条件但未做出反应的情况，我们对赎回比例进行了统计，统计方法如下：
从wind提取可转债共724支，去掉没法做赎回测试的可转债（例如没有赎回条款的，条件赎回起始日期和条件赎回截止日期获取不到的，正股代码取不到的，赎回触发计算最大时间区间为0的,赎回触发计算时间区间=0的，赎回触发比例=0的等等），还剩584只转债 -> 为总的测算样本量，统计发现584只可转债中有342个触发了赎回条款，其中238个发了赎回公告，大约占比238/342 = 69.59%

#### 7. 关于赎回条款、回售条款、下修条款的起始和结束日的处理：1）赎回起始日若取不到，用上市日往后的第193天替代。赎回结束日若取不到，用可转债到期日替代。2）回售起始日、结束日、回售比例取不到的可转债需要做异常处理 ----------待处理。3）特别修正起始日=可转债上市日，特别修正结束日=到期日，这两个值wind中取不到的暂未做处理。

假设原因：我们于2023年2月3日对WIND中提取的495只存续的可转债做了统计，发现

1）其中2.42%的可转债无法从wind中取到条件赎回起始日，其大部分是由于可转债为XX定转债券，即赎回条款约定在本次发行的可转换公司债券期满后5个交易日内，公司将向投资者赎回全部未转股的可转换公司债券，其取到的赎回比例也为0。据从wind取到值的可转债数据统计得出，赎回起始日一般为上市日往后的193天（均值），故我们假设若赎回起始日取不到，我们用193天替代。赎回结束日通常为到期日。故我们假设若结束日取不到，赎回结束日=可转债到期日。

2）回售触发比例wind取值为0的有36只，占比7.27%，个数较多，故需要对这部分取不到回售起始日、结束日、回售比例的可转债做异常处理。

3）特别修正起始日与可转债上市日基本一致，大部分为上市日期往后的2-4天，故我们假设特别修正起始日=可转债上市日。大部分可转债的特别修正结束日基本等同于可转债到期日，故我们假设特别修正结束日=到期日。这两个值取不到的占比约为1.4%，数量较少，暂不做异常处理。



#### 8. 考虑回售和下修的不确定性
1）下修期内，满足下修条件的，74%概率会下修。2）回售期内，满足回售条件的，22%回售，14%下修，剩余64%无回售或下修。3）
我们对已有的可转债下修情况作了统计，统计发现1）可转债下修只出现在下修期间内。2）下修的可转债里有44%的可转债是达到了回售的条件的。
我们假设，只要触发回售条件，公司才有意愿使用下修条款，因回售和下修也具备不确定性，故对可转债历史情况进行了统计：过程如下：
在符合测试条件的可转债中（去掉了无法测试的，因回售条件约定的日期大部分都是可转债存续的最后两年，所以很多不符合），剩余125只可转债，125只里面有50只达到了回售条件。（已确认，见sellBackTestResult.xlsx, 由sellBackTestResult-2.csv整理得来），11个发生了回售（22%），剩下的39个未发生回售的中，有7个下修了转股价（14%，因股价持续走低而发生下修-通过自行判断，以及从wind找下修公告等来判断的），32个是触发了回售条款但没回售也没下修的。（64%）。
结论：当 q<=0.22 时，触发回售条件后发生回售；当 0.22<q<0.36 时，触发回售条件且满足下修条件，则发生下修；当 q>=0.36时，即便触发回售条款，也不会发生回售或者下修，债券将继续存续。

转债的下修价格平均比条款最低价格（20 天均价和 1 天前均价的最小值）平均高出5% -- 待确认
发生下修后，其他条款应根据下修后的价格进行重新计算，回售条件的累计时间将重计。-- 待确认

### 三、定价逻辑
#### 1. 首先用蒙特卡洛模拟股价路径
首先我们对可转债的正股股价路径进行蒙特卡洛模拟，根据假设2，以及几何布朗运动公式，对正股模拟出1000条股价路径，一直模拟到可转债到期日。
下图为模拟出来的股价路径图


#### 2. 对每日的可转债状态进行判断：即赎回，回售，下修，存续

1)赎回：根据假设6，市场上69.59%的概率公司触发赎回条款时，会发赎回公告，并促使股东强制转股。因此我们设置p为0到1的随机数，当p<=0.6959时，触发赎回条件，使得债券提前赎回；在这种情况下，债权人意愿转股，可转债价值为转股价值(𝑺𝒕 ∗ 𝑭𝑽 / 𝑿)的现值，X为转股价，FV为债券面值，𝑆𝑡为当前股价。当 p>0.6959时，债券不发生赎回，继续存续。

2)回售：根据假设7，触发条件的公司中，42%会选择下修转股价。22%的公司会选择回售。36%的公司或者由于目标下修价格没有超过之前转股价，而未完成下修，或者投资者没有采用回售条款，而继续保持存续的状态。因此，我们设定下修概率q（0到1的随机数），当 q<=0.22时，触发回售条件后发生回售，转债价值为回售价格的现值。

3)下修：当 0.22<q<0.64且满足下修条款时，发生下修。根据发行人会调至下修条款中价格下限上浮 5%的价格，且即1.05 × (max(
当q>=0.7时，债券将不回售且不下修，并继续存续。

4)存续：如果没有发生赎回和回售，则可转债继续存续。一直存续至到期日的可转债价值为到期赎回价值和转股价值的最大值，

根据以上的规则，我们对每一个可转债和每一条路径进行判断。通过计算，得到每一只可转债 1000 条路径所对应的可转债价值的现值，并计算其平均数，得到可转债当前的价值。接下来，我们将模型模拟出来的可转债价格与当前市场价格作对比，分析得出可转债是否被高估或低估。

